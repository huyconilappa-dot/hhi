<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>MiniShop - Trang Ch·ªß</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <!-- Overlay cho drawer -->
    <div id="cartOverlay" class="drawer-overlay" onclick="closeCart()"></div>

    <!-- Toast Notification Container -->
    <div id="toastContainer"></div>

    <!-- Orders Modal -->
    <div id="ordersModal" class="modal-backdrop">
      <div class="modal-content" style="max-width: 800px; max-height: 80vh">
        <div class="modal-header">
          <h3><i class="fas fa-box-open"></i> ƒê∆°n h√†ng c·ªßa t√¥i</h3>
          <button class="btn-close" onclick="closeOrdersModal()">
            &times;
          </button>
        </div>
        <div class="modal-body" style="overflow-y: auto; padding: 20px">
          <div id="ordersList">
            <div style="text-align: center; padding: 40px">
              <i class="fas fa-spinner fa-spin fa-2x"></i>
              <div style="margin-top: 16px">ƒêang t·∫£i danh s√°ch ƒë∆°n h√†ng...</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="successModal" class="modal">
      <div
        class="modal-content success-box"
        style="text-align: center; padding: 30px"
      >
        <div style="font-size: 50px; color: #4caf50; margin-bottom: 20px">
          ‚úÖ
        </div>
        <h2 style="margin-bottom: 10px">ƒê·∫∑t h√†ng th√†nh c√¥ng!</h2>
        <p>C·∫£m ∆°n b·∫°n ƒë√£ mua s·∫Øm. ƒê∆°n h√†ng c·ªßa b·∫°n ƒëang ƒë∆∞·ª£c x·ª≠ l√Ω.</p>
        <p>M√£ ƒë∆°n h√†ng: <strong id="successOrderId"></strong></p>
        <div
          style="
            margin-top: 25px;
            display: flex;
            gap: 10px;
            justify-content: center;
          "
        >
          <button onclick="closeSuccessModal()" class="btn-continue">
            Ti·∫øp t·ª•c mua s·∫Øm
          </button>
          <button
            onclick="viewOrderJustPlaced()"
            class="btn-view-order"
            style="
              background: #ff4d4d;
              color: white;
              border: none;
              padding: 10px 20px;
              border-radius: 5px;
              cursor: pointer;
            "
          >
            Xem ƒë∆°n h√†ng
          </button>
        </div>
      </div>
    </div>
    <!-- Order Detail Modal -->
    <div id="orderDetailModal" class="modal-backdrop">
      <div class="modal-content" style="max-width: 700px; max-height: 90vh">
        <div class="modal-header">
          <h3 id="orderDetailTitle">
            <i class="fas fa-file-invoice"></i> Chi ti·∫øt ƒë∆°n h√†ng
          </h3>
          <button class="btn-close" onclick="closeOrderDetailModal()">
            &times;
          </button>
        </div>
        <div class="modal-body" style="overflow-y: auto; padding: 20px">
          <div id="orderDetailContent"></div>
        </div>
      </div>
    </div>

    <header class="topbar">
      <div class="brand" id="homeBtn">
        <div class="logo">M</div>
        Mini Shop
      </div>
      <div class="search">
        <input
          id="searchInput"
          placeholder="T√¨m s·∫£n ph·∫©m, v√≠ d·ª•: √°o cardigan"
          onkeypress="if(event.key === 'Enter') doSearch()"
        />
        <button onclick="doSearch()"><i class="fas fa-search"></i></button>
      </div>

      <div class="top-actions">
        <!-- Icon gi·ªè h√†ng tr√™n header -->
        <div class="icon-btn" onclick="openCart()" style="position: relative">
          <i class="fas fa-shopping-cart"></i>
          <span id="cartBadge" class="cart-bubble" style="display: none"
            >0</span
          >
        </div>

        <div class="icon-btn user-btn" id="userBtnWrapper">
          <div id="userBtn">
            <i class="fas fa-user"></i>
            <span id="userText">ƒêƒÉng nh·∫≠p</span>
            <i
              class="fas fa-caret-down"
              style="margin-left: 4px; font-size: 0.8em"
            ></i>
          </div>
          <div class="user-menu" id="userMenu">
            <div class="menu-item" onclick="goToLoginPage()">
              <i class="fas fa-sign-in-alt"></i> ƒêƒÉng nh·∫≠p
            </div>
          </div>
        </div>
      </div>
    </header>

    <main class="container">
      <section>
        <h2 style="margin: 0 0 12px 0">S·∫£n Ph·∫©m N·ªïi B·∫≠t</h2>

        <!-- Filter categories -->
<div class="categories" id="categoryFilter">
  <button class="category-btn active" data-category="all">T·∫•t c·∫£</button>
  <button class="category-btn" data-category="√Åo">√Åo</button>
  <button class="category-btn" data-category="Qu·∫ßn">Qu·∫ßn</button>
  <button class="category-btn" data-category="Gi√†y d√©p">Gi√†y d√©p</button>
  <button class="category-btn" data-category="T√∫i x√°ch">T√∫i x√°ch</button>
  <button class="category-btn" data-category="Ph·ª• ki·ªán">Ph·ª• ki·ªán</button>
</div>
<!-- Th√™m ph·∫ßn l·ªçc gi√° m·ªõi v·ªõi m√¥ t·∫£ r√µ r√†ng -->
<div class="price-filter" style="margin: 20px 0">
  <h4 style="margin: 0 0 12px 0; font-size: 16px; color: #333">
    <i class="fas fa-tags"></i> L·ªçc theo gi√° sau gi·∫£m
  </h4>
  <div class="price-buttons" style="display: flex; flex-wrap: wrap; gap: 10px">
    <button class="price-btn active" data-price="all">
      <i class="fas fa-bars"></i> T·∫•t c·∫£ gi√°
    </button>
    <button class="price-btn" data-price="under100k">
      <i class="fas fa-coins"></i> D∆∞·ªõi 100k
      <span class="price-badge">R·∫ª nh·∫•t</span>
    </button>
    <button class="price-btn" data-price="100k-300k">
      <i class="fas fa-wallet"></i> 100k - 300k
      <span class="price-badge">Ph·ªï bi·∫øn</span>
    </button>
    <button class="price-btn" data-price="300k-500k">
      <i class="fas fa-gem"></i> 300k - 500k
      <span class="price-badge">Trung c·∫•p</span>
    </button>
    <button class="price-btn" data-price="over500k">
      <i class="fas fa-crown"></i> Tr√™n 500k
      <span class="price-badge">Cao c·∫•p</span>
    </button>
  </div>
  <div class="price-filter-info" style="margin-top: 8px; font-size: 12px; color: #666; display: none;" id="priceFilterInfo">
    <i class="fas fa-info-circle"></i> ƒêang l·ªçc theo gi√° sau khi √°p d·ª•ng khuy·∫øn m√£i
  </div>
</div>
        <!-- Main products grid -->
        <div class="products" id="productGrid">
          <div style="text-align: center; padding: 40px; grid-column: 1/-1">
            <i
              class="fas fa-spinner fa-spin"
              style="font-size: 36px; color: var(--accent); margin-bottom: 16px"
            ></i>
            <div>ƒêang t·∫£i s·∫£n ph·∫©m...</div>
          </div>
        </div>

        <!-- N√∫t "Xem th√™m" s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y b·ªüi JavaScript -->
        <div
          id="loadMoreContainer"
          style="text-align: center; margin-top: 30px; padding: 20px"
        ></div>

        <!-- Discounted products section -->
        <div class="featured-section">
          <div class="section-header">
            <h3 class="section-title">S·∫£n ph·∫©m khuy·∫øn m√£i</h3>
            <a href="#" class="view-all" onclick="viewAllDiscounted()"
              >Xem t·∫•t c·∫£</a
            >
          </div>
          <div class="products" id="discountedProducts">
            <!-- Discounted products will be loaded here -->
          </div>
        </div>
      </section>
    </main>

    <!-- Cart Drawer -->
    <div id="cartDrawer" class="drawer" aria-hidden="true">
      <div class="header">
        <h3 style="margin: 0">
          <i class="fas fa-shopping-cart"></i> Gi·ªè h√†ng c·ªßa b·∫°n
        </h3>
        <div style="display: flex; gap: 8px; align-items: center">
          <button class="btn" onclick="closeCart()">
            <i class="fas fa-times"></i> ƒê√≥ng
          </button>
        </div>
      </div>

      <!-- Scrollable content -->
      <div class="drawer-content">
        <table class="cart-table" id="cartTable"></table>

        <div style="margin-top: 20px">
          <h4 style="margin: 0 0 12px 0">
            <i class="fas fa-map-marker-alt"></i> ƒê·ªãa ch·ªâ giao h√†ng
          </h4>
          <select
            id="addressSelect"
            style="
              width: 100%;
              padding: 12px;
              border-radius: 8px;
              border: 1px solid #e6e9ef;
              background: white;
              margin-bottom: 20px;
            "
          >
            <option value="HN">üè† 167 Thanh Nh√†n, Hai B√† Tr∆∞ng, H√† N·ªôi</option>
            <option value="HCM">üè¢ 55 Gi·∫£i Ph√≥ng, Hai B√† Tr∆∞ng, H√† N·ªôi</option>
            <option value="DN">üèòÔ∏è 15 L√™ Du·∫©n, H·∫£i Ch√¢u, ƒê√† N·∫µng</option>
            <option value="add-new">‚ûï Th√™m ƒë·ªãa ch·ªâ m·ªõi</option>
          </select>

          <h4 style="margin: 0 0 12px 0">
            <i class="fas fa-tag"></i> M√£ gi·∫£m gi√°
          </h4>
          <div style="display: flex; gap: 8px; margin-bottom: 20px">
            <input
              id="couponInput"
              placeholder="Nh·∫≠p m√£ gi·∫£m gi√°"
              style="
                flex: 1;
                padding: 12px;
                border-radius: 8px;
                border: 1px solid #e6e9ef;
                background: white;
              "
            />
            <button class="btn" onclick="applyCoupon()">
              <i class="fas fa-check"></i> √Åp d·ª•ng
            </button>
          </div>

          <div
            id="appliedCouponDrawer"
            style="
              padding: 12px;
              background: #f0fff4;
              border-radius: 8px;
              margin-bottom: 20px;
              display: none;
            "
          >
            <div
              style="
                display: flex;
                justify-content: space-between;
                align-items: center;
              "
            >
              <span
                ><strong id="couponCodeDrawer"></strong> - Gi·∫£m
                <span id="couponValueDrawer"></span
              ></span>
              <button
                onclick="removeCoupon()"
                style="
                  color: #ff4757;
                  background: none;
                  border: none;
                  cursor: pointer;
                  padding: 4px 8px;
                "
              >
                <i class="fas fa-times"></i> X√≥a
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Fixed footer -->
      <div class="drawer-footer">
        <div class="summary-row">
          <span>T·∫°m t√≠nh</span><span id="drawerSubtotal">0 VNƒê</span>
        </div>
        <div class="summary-row">
          <span>Khuy·∫øn m√£i</span><span id="drawerDiscount">-0 VNƒê</span>
        </div>
        <div class="summary-row">
          <span>Ph√≠ v·∫≠n chuy·ªÉn</span><span id="drawerShip">0 VNƒê</span>
        </div>
        <div
          class="summary-row"
          style="font-size: 18px; font-weight: 800; color: var(--accent)"
        >
          <span>T·ªïng c·ªông</span><span id="drawerTotal">0 VNƒê</span>
        </div>
        <button
          class="checkout-btn"
          onclick="proceedToCheckout()"
          style="margin-top: 16px"
        >
          <i class="fas fa-credit-card" style="margin-right: 8px"></i>
          Thanh to√°n
        </button>
      </div>
    </div>

    <!-- Modal Payment -->
    <div id="modalBackdrop" class="modal-backdrop">
      <div class="modal">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
          "
        >
          <h3><i class="fas fa-credit-card"></i> Thanh to√°n ƒë∆°n h√†ng</h3>
          <button class="btn" onclick="closeModal()">
            <i class="fas fa-times"></i> ƒê√≥ng
          </button>
        </div>

        <div class="payment-grid">
          <div>
            <div class="payment-method" style="margin-bottom: 16px">
              <h4><i class="fas fa-map-marker-alt"></i> ƒê·ªãa ch·ªâ giao h√†ng</h4>
              <select
                id="addressSelectModal"
                style="
                  width: 100%;
                  padding: 10px;
                  border-radius: 8px;
                  margin-top: 8px;
                  border: 1px solid #e6e9ef;
                "
              >
                <option value="HN">167 Thanh Nh√†n, Hai B√† Tr∆∞ng, H√† N·ªôi</option>
                <option value="HCM">55 Gi·∫£i Ph√≥ng, Hai B√† Tr∆∞ng, H√† N·ªôi</option>
                <option value="DN">15 L√™ Du·∫©n, H·∫£i Ch√¢u, ƒê√† N·∫µng</option>
              </select>
            </div>

            <div class="payment-method" style="margin-bottom: 16px">
              <h4><i class="fas fa-tag"></i> M√£ gi·∫£m gi√°</h4>
              <div style="display: flex; gap: 8px; margin-top: 8px">
                <input
                  id="couponInputModal"
                  placeholder="Nh·∫≠p m√£ gi·∫£m gi√°"
                  style="
                    flex: 1;
                    padding: 10px;
                    border-radius: 8px;
                    border: 1px solid #e6e9ef;
                  "
                />
                <button class="btn" onclick="applyCouponModal()">
                  <i class="fas fa-check"></i> √Åp d·ª•ng
                </button>
              </div>
              <div
                id="couponStatus"
                style="margin-top: 8px; font-size: 14px; color: var(--muted)"
              ></div>

              <div
                id="appliedCoupon"
                style="
                  margin-top: 8px;
                  padding: 8px;
                  background: #f0fff4;
                  border-radius: 6px;
                  display: none;
                "
              >
                <div
                  style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                  "
                >
                  <span
                    ><strong id="couponCode"></strong> - Gi·∫£m
                    <span id="couponValue"></span
                  ></span>
                  <button
                    onclick="removeCoupon()"
                    style="
                      color: #ff4757;
                      background: none;
                      border: none;
                      cursor: pointer;
                    "
                  >
                    <i class="fas fa-times"></i> X√≥a
                  </button>
                </div>
              </div>
            </div>

            <div class="payment-method">
              <h4>
                <i class="fas fa-money-bill-wave"></i> Ph∆∞∆°ng th·ª©c thanh to√°n
              </h4>
              <div class="tabs" style="margin-top: 8px">
                <div
                  class="tab active"
                  data-method="zalopay"
                  onclick="switchMethod(event)"
                >
                  <i class="fas fa-qrcode"></i> ZaloPay (QR)
                </div>
                <div
                  class="tab"
                  data-method="bank"
                  onclick="switchMethod(event)"
                >
                  <i class="fas fa-university"></i> Chuy·ªÉn kho·∫£n
                </div>
                <div
                  class="tab"
                  data-method="cod"
                  onclick="switchMethod(event)"
                >
                  <i class="fas fa-truck"></i> COD
                </div>
              </div>

              <div id="paymentContent" style="margin-top: 16px"></div>
            </div>
          </div>

          <aside
            style="
              padding: 16px;
              background: var(--card);
              border-radius: 10px;
              box-shadow: var(--shadow);
              align-self: flex-start;
              position: sticky;
              top: 20px;
            "
          >
            <h4><i class="fas fa-receipt"></i> T√≥m t·∫Øt ƒë∆°n h√†ng</h4>

            <div style="max-height: 300px; overflow-y: auto; margin: 12px 0">
              <div id="checkoutSummary"></div>
            </div>

            <div style="border-top: 1px solid #eef2f6; padding-top: 12px">
              <div class="summary-row">
                <span>T·∫°m t√≠nh</span>
                <span id="paySubtotal">0 VNƒê</span>
              </div>
              <div class="summary-row">
                <span>Gi·∫£m gi√°</span>
                <span id="payDiscount">-0 VNƒê</span>
              </div>
              <div class="summary-row">
                <span>Ph√≠ v·∫≠n chuy·ªÉn</span>
                <span id="payShip">0 VNƒê</span>
              </div>
              <div
                class="summary-row"
                style="font-weight: 700; font-size: 18px; color: var(--accent)"
              >
                <span>T·ªïng thanh to√°n</span>
                <span id="payTotal">0 VNƒê</span>
              </div>

              <button
                class="checkout-btn"
                onclick="confirmPayment()"
                style="margin-top: 16px"
              >
                <i class="fas fa-lock" style="margin-right: 8px"></i>
                X√°c nh·∫≠n thanh to√°n
              </button>

              <div
                style="
                  margin-top: 12px;
                  font-size: 12px;
                  color: var(--muted);
                  text-align: center;
                "
              >
                <i class="fas fa-shield-alt"></i> Thanh to√°n an to√†n & b·∫£o m·∫≠t
              </div>
            </div>
          </aside>
        </div>
      </div>
    </div>

    <script src="index.js"></script>
  </body>
</html>
